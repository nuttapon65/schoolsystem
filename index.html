var SHEET_CONFIG_NAME = "Config";
var ADMIN_PASSWORD = "1234"; // üîë ‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ

function doPost(e) {
  try {
    var params = JSON.parse(e.postData.contents);
    
    // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô
    if (params.password !== ADMIN_PASSWORD) {
       return ContentService.createTextOutput(JSON.stringify({ 
         success: false, 
         message: "‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á!" 
       })).setMimeType(ContentService.MimeType.JSON);
    }

    var action = params.action;
    var result = {};

    if (action == "get") {
      result = getGroupList();
    } else if (action == "add") {
      result = addGroup(params.name, params.id);
    } else if (action == "update") {
      result = updateGroup(params.originalName, params.name, params.id);
    } else if (action == "delete") {
      result = deleteGroup(params.name);
    }

    return ContentService.createTextOutput(JSON.stringify(result))
      .setMimeType(ContentService.MimeType.JSON);

  } catch (error) {
    return ContentService.createTextOutput(JSON.stringify({ success: false, message: error.toString() }))
      .setMimeType(ContentService.MimeType.JSON);
  }
}

// ... (‡πÉ‡∏™‡πà‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô getGroupList, addGroup, updateGroup, deleteGroup, getSheet, findRowByName ‡∏ï‡πà‡∏≠‡∏ó‡πâ‡∏≤‡∏¢‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°) ...
